<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sudoku Solver</title>
  <style>
    :root {
      --primary: #4f46e5;
      --accent: #14b8a6;
      --danger: #ef4444;
    }

    * { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }

    body {
      display: flex; align-items: center; justify-content: center;
      min-height: 100vh; margin: 0;
      position: relative;
      overflow: hidden;
    }
    
    #videoBackground {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -2;
    }
    
    #videoOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: -1;
    }
    
    #loadingIndicator {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 24px;
      z-index: -1;
      display: none;
    }

    main {
      display: flex;
      width: 900px; padding: 20px;
      border-radius: 16px;
      background: #fff;
      box-shadow: 0 8px 28px rgba(0,0,0,.15);
    }

    .sidebar {
      width: 300px;
      padding: 20px;
      border-right: 1px solid #eee;
      display: flex;
      flex-direction: column;
    }

    .sidebar > h1 {
      text-align: center;
      margin-top: 0;
    }

    .control-group {
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }

    .control-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .game-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-left: 20px;
    }

    h1 {
      margin: 0 0 12px;
      font-size: 28px;
      color: var(--primary);
      font-weight: 700;
      text-transform: uppercase;
    }

    .controls {
      display: flex; flex-wrap: wrap;
      gap: 10px; justify-content: center;
      margin-bottom: 10px;
    }

    select, button {
      width: 100%;
      margin-bottom: 8px;
      padding: 10px 14px;
      font-size: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      cursor: pointer;
      transition: all .2s ease;
    }

    select:last-child,
    button:last-child {
      margin-bottom: 0;
    }

    select:hover { border-color: var(--primary); }

    button {
      border: none; font-weight: 500; color: #fff;
    }

    #startBtn { background: var(--accent); }
    #solveBtn { background: var(--primary); }
    #clearBtn { background: var(--danger); }

    button:hover { opacity: .9; transform: translateY(-1px); }

    #timer {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--danger);
      margin: 8px 0;
      display: none;
    }

    #board {
      display: inline-block;
      margin: 16px 0;
      border: 2px solid #000;
      background: #fff;
    }

    .cell {
      width: 50px;
      height: 50px;
      border: 1px solid #999;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      vertical-align: middle;
    }

    .cell:focus {
      background: #e0e7ff;
      outline: none;
    }

    .bold-border-top { border-top: 2px solid #000; }
    .bold-border-left { border-left: 2px solid #000; }
    .bold-border-right { border-right: 2px solid #000; }
    .bold-border-bottom { border-bottom: 2px solid #000; }

    .invalid {
      background: #fee2e2 !important;
    }

    #status {
      margin-top: 10px;
      font-weight: 500;
      color: #374151;
      min-height: 20px;
    }
  </style>
</head>
<body>
  <video id="videoBackground" autoplay muted loop playsinline preload="metadata">
    <source src="https://cdn.dribbble.com/userupload/13050401/file/original-ed9e329f7167698673aa3fe548026a8c.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div id="videoOverlay"></div>
  <div id="loadingIndicator">Loading video...</div>
  <main>
    <div class="sidebar">
      <h1>Sudoku Solver</h1>
      
      <div class="control-group">
        <label for="modeSelect">Game Mode</label>
        <select id="modeSelect">
          <option value="solver">Solver</option>
          <option value="player">Player</option>
        </select>
      </div>
      
      <div class="control-group">
        <label for="levelSelect">Difficulty Level</label>
        <select id="levelSelect">
          <option value="easy">Easy</option>
          <option value="medium">Medium</option>
          <option value="hard">Hard</option>
          <option value="expert">Expert</option>
          <option value="god">God</option>
        </select>
      </div>
      
      <div class="control-group">
        <button id="startBtn">Start Game</button>
        <button id="solveBtn">Solve Puzzle</button>
        <button id="clearBtn">Clear Board</button>
      </div>
      
      <div class="control-group">
        <div id="timer">Time: 0s</div>
        <p id="status"></p>
      </div>
    </div>
    <div class="game-area">
      <div id="board"></div>
    </div>
  </main>

  <script src="puzzles.js"></script>
  <script>
    const boardEl = document.getElementById("board");
    const statusEl = document.getElementById("status");
    const timerEl = document.getElementById("timer");
    const modeSelect = document.getElementById("modeSelect");
    const levelSelect = document.getElementById("levelSelect");
    const startBtn = document.getElementById("startBtn");
    const solveBtn = document.getElementById("solveBtn");
    const clearBtn = document.getElementById("clearBtn");

    let inputs = [];
    let timer = null, seconds = 0;

    // Build Board
    const table = document.createElement("table");
    table.style.borderCollapse = "collapse";
    
    for (let row = 0; row < 9; row++) {
      const tr = document.createElement("tr");
      
      for (let col = 0; col < 9; col++) {
        const td = document.createElement("td");
        const input = document.createElement("input");
        
        input.type = "text";
        input.maxLength = 1;
        input.className = "cell";
        
        if (row % 3 === 0) input.classList.add("bold-border-top");
        if (col % 3 === 0) input.classList.add("bold-border-left");
        if (col === 8) input.classList.add("bold-border-right");
        if (row === 8) input.classList.add("bold-border-bottom");
        
        input.addEventListener("input", () => {
          input.value = input.value.replace(/[^1-9]/, "");
          validateBoard();
        });
        
        td.appendChild(input);
        tr.appendChild(td);
        inputs.push(input);
      }
      
      table.appendChild(tr);
    }
    
    boardEl.appendChild(table);

    function clearBoard() {
      inputs.forEach(cell => {
        cell.value = "";
        cell.disabled = false;
        cell.classList.remove("invalid");
      });
      statusEl.textContent = "";
      stopTimer();
      timerEl.style.display = "none";
    }

    function startGame() {
      clearBoard();
      const mode = modeSelect.value;
      const level = levelSelect.value;

      if (mode === "solver") {
        statusEl.textContent = "Enter your puzzle and click Solve.";
      } else {
        loadPuzzle(level);
        startTimer();
        statusEl.textContent = `${level.toUpperCase()} puzzle loaded ‚úÖ`;
      }
    }

    function loadPuzzle(level) {
      const puzzles = sudokuPuzzles[level];
      const puzzle = puzzles[Math.floor(Math.random() * puzzles.length)];

      for (let i = 0; i < 81; i++) {
        if (puzzle[i] === 0) {
          inputs[i].value = "";
          inputs[i].disabled = false;
        } else {
          inputs[i].value = puzzle[i];
          inputs[i].disabled = true;
        }
      }
    }

    function startTimer() {
      seconds = 0;
      timerEl.textContent = "Time: 0s";
      timerEl.style.display = "block";
      stopTimer();
      timer = setInterval(() => {
        seconds++;
        timerEl.textContent = `Time: ${seconds}s`;
      }, 1000);
    }

    function stopTimer() {
      if (timer) clearInterval(timer);
      timer = null;
    }

    function validateBoard() {
      inputs.forEach(cell => cell.classList.remove("invalid"));
      let valid = true;

      for (let i = 0; i < 81; i++) {
        const val = inputs[i].value ? parseInt(inputs[i].value) : 0;
        if (!val) continue;
        const row = Math.floor(i / 9), col = i % 9;
        if (!isValidEntry(val, row, col, i)) {
          inputs[i].classList.add("invalid");
          valid = false;
        }
      }
      return valid;
    }

    function isValidEntry(num, row, col, idx) {
      for (let i = 0; i < 9; i++) {
        if (i !== col && inputs[row * 9 + i].value == num) return false;
        if (i !== row && inputs[i * 9 + col].value == num) return false;
      }
      const sr = Math.floor(row / 3) * 3, sc = Math.floor(col / 3) * 3;
      for (let r = 0; r < 3; r++) {
        for (let c = 0; c < 3; c++) {
          const pos = (sr + r) * 9 + (sc + c);
          if (pos !== idx && inputs[pos].value == num) return false;
        }
      }
      return true;
    }

    function solve() {
      if (!validateBoard()) {
        statusEl.textContent = "‚ùå Invalid entries detected.";
        return;
      }
      const grid = inputs.map(cell => cell.value === "" ? 0 : parseInt(cell.value));
      if (sudokuSolver(grid)) {
        animateSolution(grid);
        statusEl.textContent = "Solved üéâ";
        stopTimer();
      } else {
        statusEl.textContent = "No solution found ‚ùå";
      }
    }

    function animateSolution(solution) {
      // Reset board
      for (let i = 0; i < 81; i++) {
        if (inputs[i].value === "") {
          inputs[i].value = "";
        }
      }
      
      // Animate filling in the solution
      let index = 0;
      const interval = setInterval(() => {
        if (index < 81) {
          // Only fill empty cells
          if (inputs[index].value === "") {
            inputs[index].value = solution[index];
            inputs[index].style.backgroundColor = "#e0f2fe";
            setTimeout(() => {
              inputs[index].style.backgroundColor = "";
            }, 200);
          }
          index++;
        } else {
          clearInterval(interval);
          // Celebrate win
          celebrateWin();
        }
      }, 50);
    }

    function celebrateWin() {
      // Add celebration effect
      statusEl.textContent = "üéâ Congratulations! Puzzle Solved! üéâ";
      statusEl.style.color = "#14b8a6";
      statusEl.style.fontWeight = "bold";
      
      // Animate the board
      boardEl.style.transform = "scale(1)";
      boardEl.style.transition = "transform 0.3s";
      
      // Pulse animation
      let scale = 1;
      let direction = 1;
      const pulse = setInterval(() => {
        scale += direction * 0.02;
        if (scale > 1.1) direction = -1;
        if (scale < 1) direction = 1;
        boardEl.style.transform = `scale(${scale})`;
        
        // Stop after 3 seconds
        setTimeout(() => {
          clearInterval(pulse);
          boardEl.style.transform = "scale(1)";
        }, 3000);
      }, 50);
    }

    function sudokuSolver(grid) {
      function isValid(num, row, col) {
        for (let i = 0; i < 9; i++) {
          if (grid[row * 9 + i] === num) return false;
          if (grid[i * 9 + col] === num) return false;
        }
        const sr = Math.floor(row / 3) * 3, sc = Math.floor(col / 3) * 3;
        for (let r = 0; r < 3; r++) {
          for (let c = 0; c < 3; c++) {
            if (grid[(sr + r) * 9 + (sc + c)] === num) return false;
          }
        }
        return true;
      }

      function backtrack(idx) {
        if (idx === 81) return true;
        if (grid[idx] !== 0) return backtrack(idx + 1);
        const row = Math.floor(idx / 9), col = idx % 9;
        for (let num = 1; num <= 9; num++) {
          if (isValid(num, row, col)) {
            grid[idx] = num;
            if (backtrack(idx + 1)) return true;
            grid[idx] = 0;
          }
        }
        return false;
      }
      return backtrack(0);
    }

    startBtn.addEventListener("click", startGame);
    solveBtn.addEventListener("click", solve);
    clearBtn.addEventListener("click", clearBoard);
    
    // Video loading optimization
    const videoBackground = document.getElementById('videoBackground');
    const loadingIndicator = document.getElementById('loadingIndicator');
    
    // Show loading indicator
    loadingIndicator.style.display = 'block';
    
    videoBackground.addEventListener('loadeddata', function() {
      // Hide loading indicator when video is loaded
      loadingIndicator.style.display = 'none';
    });
    
    videoBackground.addEventListener('error', function() {
      // Hide loading indicator and show fallback if video fails to load
      loadingIndicator.style.display = 'none';
    });
    
    // Try to load video immediately
    videoBackground.load();
  </script>
</body>
</html>
